import{a as t,b as a,c as s,d as n,e,f as o,i as r,s as i,g as c,S as u,R as p,j as l,J as f,Q as h,m,n as g,q as d,u as v,A as $,B as b,K as P,L as k,w as x,h as w,x as L,k as j,l as _,y,p as N,z as q,C}from"./client.076f2118.js";import{a as E,b as I}from"./_api.d1f0ee42.js";import"./showdown.ea3586f6.js";import{L as B}from"./ListPagination.b8572030.js";import{P as D}from"./PostList.6799b01d.js";function J(t){return{c:x,l:x,m:x,p:x,i:x,o:x,d:x}}function S(t){var a,s,n,e,o=new D({props:{posts:t[10],username:t[3]}}),r=new B({props:{articlesCount:t[2],articlesPerPage:t[1].posts_per_page,objectPath:"/blog/"+t[3]+"/posts",page:t[4]}});return{c:function(){a=w("div"),L(o.$$.fragment),s=l(),n=w("div"),L(r.$$.fragment),this.h()},l:function(t){a=j(t,"DIV",{class:!0});var e=_(a);y(o.$$.fragment,e),e.forEach(m),s=g(t),n=j(t,"DIV",{class:!0});var i=_(n);y(r.$$.fragment,i),i.forEach(m),this.h()},h:function(){N(a,"class","row"),N(n,"class","row")},m:function(t,i){d(t,a,i),q(o,a,null),d(t,s,i),d(t,n,i),q(r,n,null),e=!0},p:function(t,a){var s={};1&a&&(s.posts=t[10]),8&a&&(s.username=t[3]),o.$set(s);var n={};4&a&&(n.articlesCount=t[2]),2&a&&(n.articlesPerPage=t[1].posts_per_page),8&a&&(n.objectPath="/blog/"+t[3]+"/posts"),16&a&&(n.page=t[4]),r.$set(n)},i:function(t){e||($(o.$$.fragment,t),$(r.$$.fragment,t),e=!0)},o:function(t){b(o.$$.fragment,t),b(r.$$.fragment,t),e=!1},d:function(t){t&&m(a),C(o),t&&m(s),t&&m(n),C(r)}}}function V(t){return{c:x,l:x,m:x,p:x,i:x,o:x,d:x}}function z(t){var a,s,n,e,o={ctx:t,current:null,token:null,pending:V,then:S,catch:J,value:10,blocks:[,,,]};return p(n=t[0],o),{c:function(){a=l(),s=f(),o.block.c(),this.h()},l:function(t){h('[data-svelte="svelte-10h7psl"]',document.head).forEach(m),a=g(t),s=f(),o.block.l(t),this.h()},h:function(){document.title="Blog"},m:function(t,n){d(t,a,n),d(t,s,n),o.block.m(t,o.anchor=n),o.mount=function(){return s.parentNode},o.anchor=s,e=!0},p:function(a,s){var e=v(s,1)[0];if(t=a,o.ctx=t,1&e&&n!==(n=t[0])&&p(n,o));else{var r=t.slice();r[10]=o.resolved,o.block.p(r,e)}},i:function(t){e||($(o.block),e=!0)},o:function(t){for(var a=0;a<3;a+=1){var s=o.blocks[a];b(s)}e=!1},d:function(t){t&&m(a),t&&m(s),o.block.d(t),o.token=null,o=null}}}function A(t){return K.apply(this,arguments)}function K(){return(K=t(a.mark(function t(s){var n,e,o,r,i,c,u,p,l,f,h;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s.host,n=s.path,e=s.params,o=s.query,console.log("params in posts index",JSON.stringify(e)),(r=parseInt(o.page))||this.redirect(302,"".concat(e.theuser,"/posts?page=1")),t.next=6,I(e.theuser);case 6:return i=t.sent,r>0&&r--,console.log(i.length),c=i.length,t.next=12,E(e.theuser);case 12:return u=t.sent,p=u.posts_per_page||5,l=r*p,f=r*p+p,h=i.slice(l,f),t.abrupt("return",{path:n,posts:h,totalPostsLength:c,metadata:u});case 18:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function O(t,a,s){var n,e=a.posts,o=void 0===e?[]:e,r=a.metadata,i=a.totalPostsLength,c=a.path,u=P(),p=(u.preloading,u.page);u.session;k(t,p,function(t){return s(7,n=t)}),console.log("in posts index",n.params);var l=a.username,f=void 0===l?n.params.theuser:l,h=a.pageNum,m=void 0===h?n.query.page:h;return t.$set=function(t){"posts"in t&&s(0,o=t.posts),"metadata"in t&&s(1,r=t.metadata),"totalPostsLength"in t&&s(2,i=t.totalPostsLength),"path"in t&&s(6,c=t.path),"username"in t&&s(3,f=t.username),"pageNum"in t&&s(4,m=t.pageNum)},[o,r,i,f,m,p,c]}export default(function(t){function a(t){var s;return n(this,a),s=e(this,o(a).call(this)),r(c(s),t,O,z,i,{posts:0,metadata:1,totalPostsLength:2,path:6,username:3,pageNum:4}),s}return s(a,u),a}());export{A as preload};
