import{a as t,b as s,c as a,d as n,e,f as o,i as r,s as i,g as c,S as u,R as p,j as l,J as f,Q as h,m,n as g,q as d,u as v,A as $,B as b,K as P,L as k,w as x,h as w,x as L,k as j,l as _,y,p as N,z as q,C}from"./client.f04795c4.js";import{a as E,b as I}from"./_api.10f3610e.js";import"./showdown.811dd8b6.js";import{L as B}from"./ListPagination.376eff6f.js";import{P as D}from"./PostList.cc2b217d.js";function J(t){return{c:x,l:x,m:x,p:x,i:x,o:x,d:x}}function S(t){var s,a,n,e,o=new D({props:{posts:t[10],username:t[3]}}),r=new B({props:{articlesCount:t[2],articlesPerPage:t[1].posts_per_page,objectPath:"/blog/"+t[3]+"/posts",page:t[4]}});return{c:function(){s=w("div"),L(o.$$.fragment),a=l(),n=w("div"),L(r.$$.fragment),this.h()},l:function(t){s=j(t,"DIV",{class:!0});var e=_(s);y(o.$$.fragment,e),e.forEach(m),a=g(t),n=j(t,"DIV",{class:!0});var i=_(n);y(r.$$.fragment,i),i.forEach(m),this.h()},h:function(){N(s,"class","row"),N(n,"class","row")},m:function(t,i){d(t,s,i),q(o,s,null),d(t,a,i),d(t,n,i),q(r,n,null),e=!0},p:function(t,s){var a={};1&s&&(a.posts=t[10]),8&s&&(a.username=t[3]),o.$set(a);var n={};4&s&&(n.articlesCount=t[2]),2&s&&(n.articlesPerPage=t[1].posts_per_page),8&s&&(n.objectPath="/blog/"+t[3]+"/posts"),16&s&&(n.page=t[4]),r.$set(n)},i:function(t){e||($(o.$$.fragment,t),$(r.$$.fragment,t),e=!0)},o:function(t){b(o.$$.fragment,t),b(r.$$.fragment,t),e=!1},d:function(t){t&&m(s),C(o),t&&m(a),t&&m(n),C(r)}}}function V(t){return{c:x,l:x,m:x,p:x,i:x,o:x,d:x}}function z(t){var s,a,n,e,o={ctx:t,current:null,token:null,pending:V,then:S,catch:J,value:10,blocks:[,,,]};return p(n=t[0],o),{c:function(){s=l(),a=f(),o.block.c(),this.h()},l:function(t){h('[data-svelte="svelte-10h7psl"]',document.head).forEach(m),s=g(t),a=f(),o.block.l(t),this.h()},h:function(){document.title="Blog"},m:function(t,n){d(t,s,n),d(t,a,n),o.block.m(t,o.anchor=n),o.mount=function(){return a.parentNode},o.anchor=a,e=!0},p:function(s,a){var e=v(a,1)[0];if(t=s,o.ctx=t,1&e&&n!==(n=t[0])&&p(n,o));else{var r=t.slice();r[10]=o.resolved,o.block.p(r,e)}},i:function(t){e||($(o.block),e=!0)},o:function(t){for(var s=0;s<3;s+=1){var a=o.blocks[s];b(a)}e=!1},d:function(t){t&&m(s),t&&m(a),o.block.d(t),o.token=null,o=null}}}function A(t){return K.apply(this,arguments)}function K(){return(K=t(s.mark(function t(a){var n,e,o,r,i,c,u,p,l,f,h;return s.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.host,n=a.path,e=a.params,o=a.query,console.log("params in posts index",JSON.stringify(e)),(r=parseInt(o.page))||this.redirect(302,"".concat(e.theuser,"/posts?page=1")),t.next=6,I(e.theuser);case 6:return i=t.sent,r>0&&r--,console.log(i.length),c=i.length,t.next=12,E(e.theuser);case 12:return u=t.sent,p=u.posts_per_page||5,l=r*p,f=r*p+p,h=i.slice(l,f),t.abrupt("return",{path:n,posts:h,totalPostsLength:c,metadata:u});case 18:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function O(t,s,a){var n,e=s.posts,o=void 0===e?[]:e,r=s.metadata,i=s.totalPostsLength,c=s.path,u=P(),p=(u.preloading,u.page);u.session;k(t,p,function(t){return a(7,n=t)}),console.log("in posts index",n.params);var l=s.username,f=void 0===l?n.params.theuser:l,h=s.pageNum,m=void 0===h?n.query.page:h;return t.$set=function(t){"posts"in t&&a(0,o=t.posts),"metadata"in t&&a(1,r=t.metadata),"totalPostsLength"in t&&a(2,i=t.totalPostsLength),"path"in t&&a(6,c=t.path),"username"in t&&a(3,f=t.username),"pageNum"in t&&a(4,m=t.pageNum)},[o,r,i,f,m,p,c]}export default(function(t){function s(t){var a;return n(this,s),a=e(this,o(s).call(this)),r(c(a),t,O,z,i,{posts:0,metadata:1,totalPostsLength:2,path:6,username:3,pageNum:4}),a}return a(s,u),s}());export{A as preload};
