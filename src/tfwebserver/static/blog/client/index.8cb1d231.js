import{S as t,i as e,s,e as a,t as n,c as o,a as r,k as l,d as p,b as i,f as c,g as h,D as u,o as m,h as g,H as d,j as f,A as b,B as _,p as $,q as y,n as k,x as P,y as v,z as w,C as x}from"./client.022bb516.js";import{d as j,a as L}from"./_api.5f596b86.js";import"./showdown.20a62d9b.js";import{L as N}from"./ListPagination.d5d8a8a6.js";import{P as C}from"./PostList.e45831f7.js";function E(t){let e,s;return{c(){e=a("script"),s=n('cookieconsent.run({\n        notice_banner_type: "headline",\n        consent_type: "express",\n        palette: "light",\n        language: "en",\n        website_name: "https://blog.threefold.io/",\n        cookies_policy_url: "https://wiki.threefold.io/#/privacypolicy"\n      });'),this.h()},l(t){e=o(t,"SCRIPT",{type:!0});var a=r(e);s=l(a,'cookieconsent.run({\n        notice_banner_type: "headline",\n        consent_type: "express",\n        palette: "light",\n        language: "en",\n        website_name: "https://blog.threefold.io/",\n        cookies_policy_url: "https://wiki.threefold.io/#/privacypolicy"\n      });'),a.forEach(p),this.h()},h(){i(e,"type","text/javascript")},m(t,a){c(t,e,a),h(e,s)},d(t){t&&p(e)}}}function I(t){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function q(t){let e,s,n,l;const h=new C({props:{posts:t[10],username:t[3]}}),u=new N({props:{articlesCount:t[2],articlesPerPage:t[1].posts_per_page,objectPath:"/blog/"+t[3]+"/posts",page:t[4]}});return{c(){e=a("div"),P(h.$$.fragment),s=g(),n=a("div"),P(u.$$.fragment),this.h()},l(t){e=o(t,"DIV",{class:!0});var a=r(e);v(h.$$.fragment,a),a.forEach(p),s=f(t),n=o(t,"DIV",{class:!0});var l=r(n);v(u.$$.fragment,l),l.forEach(p),this.h()},h(){i(e,"class","row"),i(n,"class","row")},m(t,a){c(t,e,a),w(h,e,null),c(t,s,a),c(t,n,a),w(u,n,null),l=!0},p(t,e){const s={};1&e&&(s.posts=t[10]),8&e&&(s.username=t[3]),h.$set(s);const a={};4&e&&(a.articlesCount=t[2]),2&e&&(a.articlesPerPage=t[1].posts_per_page),8&e&&(a.objectPath="/blog/"+t[3]+"/posts"),16&e&&(a.page=t[4]),u.$set(a)},i(t){l||(b(h.$$.fragment,t),b(u.$$.fragment,t),l=!0)},o(t){_(h.$$.fragment,t),_(u.$$.fragment,t),l=!1},d(t){t&&p(e),x(h),t&&p(s),t&&p(n),x(u)}}}function D(t){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function S(t){let e,s,a,n,o,r=t[1].privacy_popup&&E(),l={ctx:t,current:null,token:null,pending:D,then:q,catch:I,value:10,blocks:[,,,]};return u(n=t[0],l),{c(){r&&r.c(),e=m(),s=g(),a=m(),l.block.c(),this.h()},l(t){const n=d('[data-svelte="svelte-zp0xhd"]',document.head);r&&r.l(n),e=m(),n.forEach(p),s=f(t),a=m(),l.block.l(t),this.h()},h(){document.title="Blog"},m(t,n){r&&r.m(document.head,null),h(document.head,e),c(t,s,n),c(t,a,n),l.block.m(t,l.anchor=n),l.mount=(()=>a.parentNode),l.anchor=a,o=!0},p(s,[a]){if((t=s)[1].privacy_popup?r||((r=E()).c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),l.ctx=t,1&a&&n!==(n=t[0])&&u(n,l));else{const e=t.slice();e[10]=l.resolved,l.block.p(e,a)}},i(t){o||(b(l.block),o=!0)},o(t){for(let t=0;t<3;t+=1){const e=l.blocks[t];_(e)}o=!1},d(t){r&&r.d(t),p(e),t&&p(s),t&&p(a),l.block.d(t),l.token=null,l=null}}}async function z({host:t,path:e,params:s,query:a}){console.log("params in posts index",JSON.stringify(s));let n=parseInt(a.page);n||this.redirect(302,`${s.theuser}/posts?page=1`);let o=await j(s.theuser);n>0&&n--,console.log(o.length);let r=o.length;const l=await L(s.theuser);let p=l.posts_per_page||5,i=n*p,c=n*p+p;return{path:e,posts:o.slice(i,c),totalPostsLength:r,metadata:l}}function B(t,e,s){let a,{posts:n=[]}=e,{metadata:o}=e,{totalPostsLength:r}=e,{path:l}=e;const{preloading:p,page:i,session:c}=$();y(t,i,t=>s(7,a=t)),console.log("in posts index",a.params);let{username:h=a.params.theuser}=e,{pageNum:u=a.query.page}=e;return t.$set=(t=>{"posts"in t&&s(0,n=t.posts),"metadata"in t&&s(1,o=t.metadata),"totalPostsLength"in t&&s(2,r=t.totalPostsLength),"path"in t&&s(6,l=t.path),"username"in t&&s(3,h=t.username),"pageNum"in t&&s(4,u=t.pageNum)}),[n,o,r,h,u,i,l]}export default class extends t{constructor(t){super(),e(this,t,B,S,s,{posts:0,metadata:1,totalPostsLength:2,path:6,username:3,pageNum:4})}}export{z as preload};
